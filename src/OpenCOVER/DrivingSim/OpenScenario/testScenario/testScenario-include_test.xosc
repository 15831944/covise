<?xml version="1.0" encoding="utf-8"?>
<test xmlns:xi="http://www.w3.org/2001/XInclude">

  <environment name="day">

    <header author="PW" date="2015-10-20T12:15:00+01:00" description="testEnvironment" revMajor="1" revMinor="0"/>

    <timeOfDay animation="1">
      <time hour="12" min="15" sec="30"/>
      <date day="20" month="10" year="2015"/>
    </timeOfDay>

    <weather cloudState="free">

      <xi:include href="testScen-incl_sun.xosc"/>

      <fog visibility="0.9">
	<color b="100" g="100" r="100"/>
	<boundingBox>
	  <center h="5" x="10" y="10" z="10"/>
	  <dimensions height="1000" length="1000" width="1000"/>
	</boundingBox>
      </fog>

      <precipitation intensity="0.5" type="dry"/>

    </weather>

    <xi:include href="testScen-incl_roadConds.xosc"/>

  </environment>

  <vehicle color="red" licensePlate="123456" manufacturer="Porsche" model="911" name="porsche911" vehicleClass="car">
    <header author="PW" date="2015-10-20T12:15:00+01:00" description="testEnvironment" revMajor="1" revMinor="0"/>
    <performance maxDeceleration="10" maxSpeed="200" overallEfficiency="50">
      <aerodynamics airDragCoefficient="0.5" frontSurfaceEffective="0.2"/>
      <engine maxRpm="3000" power="300" type="V6"/>
      <cog mass="1000" positionX="0" positionY="1" positionZ="3"/>
      <gearbox type="manual"/>
    </performance>
    <geometry URL="porsche.max"/>
    <dimensions bottom="1" front="1.5" left="1.2" rear="3" right="1" top="1"/>
    <axles>
      <front driven="1" maxSteering="180" positionX="2" positionZ="0" rollingResistance="0.22" trackWidth="1.5" wheelDiameter="0.5"/>
      <rear driven="1" maxSteering="180" positionX="2" positionZ="0" rollingResistance="0.22" trackWidth="1.5" wheelDiameter="0.5"/>
      <n driven="1" maxSteering="180" positionX="2" positionZ="0" rollingResistance="0.22" trackWidth="1.5" wheelDiameter="0.5"/>
    </axles>
    <eyepoints>
      <eyepoint type="top">
	<coord>
	  <position x="0" y="0" z="0"/>
	  <orientation h="0" p="0" r="0"/>
	</coord>
      </eyepoint>
    </eyepoints>
    <lighting>
      <light frequency="0.2" type="top">
	<coord>
	  <position x="0" y="0" z="0"/>
	  <orientation h="0" p="0" r="0"/>
	</coord>
	<light>
	  <color b="30" g="30" r="30"/>
	  <intensity ambient="0.5" diffuse="0.5" specular="0.5"/>
	</light>
      </light>
    </lighting>
    <mirrors>
      <mirror type="top">
	<coord>
	  <position x="0.000000" y="0.000000" z="0.000000"/>
	  <orientation h="0.000000" p="0.000000" r="0.000000"/>
	</coord>
      </mirror>
    </mirrors>
    <features>
      <feature availability="1" type="a"/>
    </features>
    <userData code="A" value="b"/>
  </vehicle>

  <pedestrian mass="25" model="111.xml" name="peter" pedestrianClass="animal" refId="111">
    <header author="PW" date="2015-08-17T11:55:00+01:00" description="pedestrian" revMajor="1" revMinor="0"/>
    <behavior alertness="0.1" politeness="1"/>
    <dimension bottom="1" front="1.5" left="1.2" rear="3" right="1" top="1"/>
    <geometry URL="DOG.MAX"/>
  </pedestrian>

  <observer name="sss" refId="123" type="ddd">
    <header author="PW" date="2015-08-17T11:55:00+01:00" description="observer" revMajor="1" revMinor="0"/>
    <frustum bottom="2.3" far="0.2" left="1" near="0.1" right="2.2" top="1"/>
    <filter filterParam="2.22" maxNum="20" objectType="dfg"/>
    <userData code="A" value="b"/>
  </observer>

  <miscObject mass="3000" name="ccc" type="cccc">
    <header author="PW" date="2015-11-23T12:15:00+01:00" description="miscObject" revMajor="1" revMinor="0"/>
    <dimensions bottom="1" front="1.5" left="1.2" rear="3" right="1" top="1"/>
    <geometry URL="3d.max"/>
  </miscObject>

  <entity name="b" refId="2">
    <objectChoice>
      <OSCVehicle name="a" refId="1"/>
      <OSCPedestrian name="a" refId="1"/>
      <OSCMiscObject name="a" refId="1"/>
    </objectChoice>
    <controllerChoice>
      <OSCDriverReference name="a" refId="1"/>
      <PedestrianController motion="run"/>
    </controllerChoice>
    <observer iid="222" name="a" refId="1">
      <coord>
	<position x="0" y="0" z="0"/>
	<orientation h="0" p="0" r="0"/>
      </coord>
    </observer>
  </entity>

  <routing>
    <header author="UW" date="2015-08-17T11:55:00+01:00" description="testScenario" revMajor="1" revMinor="0"/>
    <general closed="0" name="round">
      <userData code="A" value="b"/>
    </general>
    <waypoint>
      <position>
	<positionRoad h="1" p="1" r="1" relativeOrientation="1" roadId="a" s="1" t="1"/>
      </position>
      <continuation>
	<route strategy="random"/>
	<shape polyline="s" purpose="steering">
	  <clothoid curvature="1" curvatureDot="2" length="2"/>
	  <spline controlPoint1="a" controlPoint2="b"/>
	</shape>
      </continuation>
    </waypoint>
    <userData code="A" value="b"/>
  </routing>

  <driver adaptToRoadConditions="20" adaptToTimeOfDay="19" adaptToVehicleType="18" adaptToWeatherConditions="21" alertness="17" curveSpeed="12" desiredAcceleration="14" desiredDeceleration="13" desiredVelocity="15" distanceKeeping="10" foresightDistance="2" keepRightRule="6" laneChangeDynamic="7" laneKeeping="9" name="joe" obeyTrafficLights="0" obeyTrafficSigns="1" observeSpeedLimits="11" politeness="16" respondToTailgating="3" speedKeeping="8" steeringDistance="1" urgeToOvertake="4" useOfIndicator="5">
    <header author="PW" date="2015-11-23T12:15:00+01:00" description="testDriver" revMajor="1" revMinor="0"/>  
    <body eyeDistance="65" height="180" sex="male" weight="75"/>
    <geometry URL="3d.max"/> 
  </driver>

  <position>
    <positionWorld h="10" p="10" r="10" x="10" y="10" z="10"/>
    <positionRoad h="10" p="10" r="10" relativeOrientation="0" roadId="1" s="2" t="3"/>
    <positionLane h="10" laneId="2" offset="1" p="10" r="10" relativeOrientation="0" roadId="1" s="1"/>
    <relativePositionWorld dx="1" dy="2" dz="3" h="1" p="2" r="3" refObject="a"/>
    <relativePositionRoad ds="1" dt="2" h="1" p="2" r="3" refObject="a" relativeOrientation="0"/>
    <relativePositionLane dLane="2" ds="1" h="10" offset="1" p="10" r="10" refObject="a" relativeOrientation="0"/>
    <positionRoute current="0" h="10" p="10" r="10" relativeOrientation="0" routeId="a">
      <roadCoord pathS="1" t="2"/>
      <laneCoord laneId="2" laneOffset="3" pathS="1"/>
    </positionRoute>
  </position>

  <maneuver name="ChangeLane">
    <header author="UW" date="2015-08-17T11:55:00+01:00" description="testScenario" revMajor="1" revMinor="0"/>
    <event name="takeover" priority="skip">
      <startConditionGroup>
	<startCondition delayTime="0.3" name="sss">
	  <userData code="asd" value="ert"/>
	  <condition>
	    <command name="start"/>
	  </condition>
	</startCondition>
      </startConditionGroup>
      <action>
	<autonomous activate="0" driver="joe"/>
	<speed>
	  <dynamics immediate="2" rate="1.22" shape="round"/>
	  <relative delta="5" factor="3.333" refObject="w"/>
	  <absolute target="22.222"/>
	</speed>
	<laneChange targetLaneOffset="4.5567">
	  <relative delta="5" refObject="w"/>
	  <absolute target="22.222"/>
	  <dynamics duration="9.888" maxLateralAcc="2.987" shape="round"/>
	</laneChange>
	<laneOffset>
	  <relative delta="5" refObject="w"/>
	  <absolute target="22.222"/>
	  <dynamics duration="9.888" maxLateralAcc="2.987"/>
	</laneOffset>
	<position/>
	<distanceLateral distance="3.333" freespace="1" refObject="w"/>
	<distanceLongitudinal distance="3.333" freespace="1" refObject="w" timeGap="2.222"/>
	<visibility graphics="0" sensors="1" traffic="0"/>
	<characterAppearance feature="ww" value="oo"/>
	<characterGesture gesture="ss"/>
	<characterMotion motionType="dd"/>
	<trafficLight>
	  <setController name="q" state="e"/>
	  <setState name="q" state="e"/>
	</trafficLight>
	<entityAdd name="q">
	  <position>
	    <positionLane h="10" laneId="2" offset="1" p="10" r="10" relativeOrientation="0" roadId="1" s="1"/>
	  </position>
	</entityAdd>
	<entityDelete name="q"/>
	<trafficJam>
	  <position>
	    <relativePositionWorld dx="1" dy="2" dz="3" h="1" p="2" r="3" refObject="a"/>
	  </position>
	</trafficJam>
	<trafficSource distance="vehicle" forward="0" rate="1.1111" velocity="3.4456" velocityDeviation="8.1">
	  <position>
	    <relativePositionRoad ds="1" dt="2" h="1" p="2" r="3" refObject="a" relativeOrientation="0"/>
	  </position>
	</trafficSource>
	<trafficSink>
	  <position>
	    <relativePositionLane dLane="2" ds="1" h="10" offset="1" p="10" r="10" refObject="a" relativeOrientation="0"/>
	  </position>
	</trafficSink>
	<userDefinedAction name="op">
	  <parameter name="wer" type="ijn" value="098">
	  </parameter>
	</userDefinedAction>
	<userDefinedCommand command="qwe"/>
	<userScript execution="waitForTermination" name="qwe">
	  <parameter name="11" type="s" value="dd"/>
	  <file URL="ss"/>
	</userScript>
	<notify text="aaa"/>
	<userData code="asd" value="ert"/>
      </action>
    </event>
  </maneuver>

  <condition>
    <simulationTime simulationTime="30"/>
    <timeOfDay animation="1">
      <time hour="12" min="15" sec="30"/>
      <date day="20" month="10" year="2015"/>
    </timeOfDay>
    <reachPosition conditions="exceed" tolerance="0.5">
      <position>
	<positionRoute current="0" h="10" p="10" r="10" relativeOrientation="0" routeId="a">
	  <roadCoord pathS="1" t="2"/>
	  <laneCoord laneId="2" laneOffset="3" pathS="1"/>
	</positionRoute>
      </position>
    </reachPosition>
    <distance condition="decceed" freespace="1" object="V1" refObject="V2" value="50"/>
    <velocity condition="decceed" object="V1" refObject="V2" reference="relative" value="50"/>
    <standsStill duration="60" object="V3"/>
    <acceleration condition="decceed" object="V1" refObject="V2" reference="relative" value="50"/>
    <stoppingDistance condition="decceed" freespace="1" object="V1" refObject="V2" value="50">
      <position>
	<positionRoute current="0" h="10" p="10" r="10" relativeOrientation="0" routeId="a">
	  <roadCoord pathS="1" t="2"/>
	  <laneCoord laneId="2" laneOffset="3" pathS="1"/>
	</positionRoute>
      </position>
    </stoppingDistance>
    <timeToCollision condition="decceed" freespace="1" object="V1" refObject="V2" value="50">
      <position>
	<positionRoute current="0" h="10" p="10" r="10" relativeOrientation="0" routeId="a">
	  <roadCoord pathS="1" t="2"/>
	  <laneCoord laneId="2" laneOffset="3" pathS="1"/>
	</positionRoute>
      </position>
    </timeToCollision>
    <timeHeadway condition="decceed" freespace="1" object="V1" refObject="V2" value="50">
      <position>
	<positionRoute current="0" h="10" p="10" r="10" relativeOrientation="0" routeId="a">
	  <roadCoord pathS="1" t="2"/>
	  <laneCoord laneId="2" laneOffset="3" pathS="1"/>
	</positionRoute>
      </position>
    </timeHeadway>
    <referenceHanding conditionRef="starts" eventId="321" maneuverId="123"/>
    <offroad duration="100" object="wa"/>
    <collision object="aaa">
      <partner object="bbb" objectType="vehicle"/>
    </collision>
    <numericCondition name="May" rule="equal" value="20"/>
    <command name="joe"/>
    <userDefined uid="ccc">
      <parameter name="ff" type="w" value="2"/>
    </userDefined>
  </condition>

  </test>
